# 手动收集EGL_Component的源文件，避免包含3rdparty目录下的文件 防止MSVC编译错误
file( GLOB_RECURSE EGL_SOURCES 
    "*.cpp"
    "*.c"
)

# 排除3rdparty目录下的所有文件
list(FILTER EGL_SOURCES EXCLUDE REGEX "3rdparty/.*")

# 排除特定的文件
list(REMOVE_ITEM EGL_SOURCES
    "${CMAKE_CURRENT_SOURCE_DIR}/ModelLoader/ModelLoader_Universal.cpp"
    "${CMAKE_CURRENT_SOURCE_DIR}/ModelLoader/ModelLoader_Universal.hpp"
)

# 将这个组件定义为一个库
add_library( EGL_Component ${EGL_SOURCES} )

# 宏定义
target_compile_definitions( EGL_Component PRIVATE ENABLE_INSTANCING )
# 为这个库指头文件搜索路径 PUBLIC: 表示任何连接了EGL_Component的目标都会自动获得这个头文件路径
# CMAKE_CURRENT_SOURCE_DIR 代表当前 CMakelists.txt所在的目录
target_include_directories( EGL_Component PUBLIC 
                            ${CMAKE_CURRENT_SOURCE_DIR} 
                            ${CMAKE_CURRENT_SOURCE_DIR}/3rdparty/assimp/include
                            ${CMAKE_CURRENT_SOURCE_DIR}/3rdparty
                            ${CMAKE_CURRENT_SOURCE_DIR}/3rdparty/SOIL2
                            ${CMAKE_CURRENT_SOURCE_DIR}/3rdparty/glad/include
                            ${CMAKE_CURRENT_SOURCE_DIR}/3rdparty/glfw/include
                            ${CMAKE_CURRENT_SOURCE_DIR}/component
                            ${CMAKE_CURRENT_SOURCE_DIR}/Common
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_FBO
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_3DModels
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_Offscreen
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_LoadingView
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_Shader_Blinn_Phong
                            ${CMAKE_CURRENT_SOURCE_DIR}/ModelLoader
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_Camera
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_Silhouette
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_Mouse
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_UBO
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_Box
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_Instancing
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_Skybox
                            ${CMAKE_CURRENT_SOURCE_DIR}/Component_TextureManager
                            )


# GLAD库 
add_subdirectory(3rdparty/glad)
# Assimp库
add_subdirectory(3rdparty/assimp)
# GLFW库
add_subdirectory(3rdparty/glfw)
# SOIL2库
add_subdirectory(3rdparty/SOIL2)


# EGL_Component 自身有依赖的库; 任何连接了EGL_Component的目标也会自动连接上这些库
target_link_libraries( EGL_Component 
                        PUBLIC 
                        OpenGL::GL
                        ${CMAKE_CURRENT_SOURCE_DIR}/3rdparty/assimp/windows-x64-msvc/assimp-vc143-mtd.lib
                        ${CMAKE_CURRENT_SOURCE_DIR}/3rdparty/assimp/windows-x64-msvc/zlib.lib
                        glfw
                        glad
                        SOIL2
                        )

